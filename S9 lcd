#include <xc.h>
#include "h1.h"
#define _XTAL_FREQ 8000000UL

#define RW LATDbits.LATD5;
#define RS LATDbits.LATD6;
#define E LATDbits.LATD7;



void GPIO_LCD(void);
void LCD_Init(char);
void Send_CMD(char);
void Send_DATA(char);
void Lin_Col_pos(char,char);
void send_String(void);

void main(void) 
{
    
    
}



void GPIO_LCD(void)
{
    TRISD = 0x00;
    LATD = 0x00;
}

void LCD_Init(void)
{
    GPIO_LCD();
    __delay_ms(20);
    Send_CMD(0x30);
    __delay_ms(5);
    Send_CMD(0x30);
    __delay_ms(1);
    Send_CMD(0x32); //4 bits
    __delay_ms(1);
    Send_CMD(0x28); // 2 lineas 5x8
    Send_CMD(0x0C); // display ON
    Send_CMD(0x01); //Borrar LCD
    Send_CMD(0x06); //Incremento
    __delay_ms(100);
}

void Send_CMD(char cmd)
{
    
}

void Send_CMD()
{
    RW = 0;
    RS = 0;
    DATA_LCD &=0xF0;
    DATA_LCD |= (cmd>>4) & 0x0F;
    E = 1;
    E = 0;
    __delay_ms(1);
    DATA_LCD &= 0xF0;
    DATA_LCD |= (cmd & 0x0F);
    E = 1;
    E = 0;
    __delay_ms(1);
}

void(send_DATA)(char dato)
{
    RW = 0;
    RS = 1;
    DATA_LCD &=0xF0;
    DATA_LCD |= (dato>>4) & 0x0F;
    E = 1;
    E = 0;
    __delay_ms(1);
    DATA_LCD &= 0xF0;
    DATA_LCD |= (dato & 0x0F);
    E = 1;
    E = 0;
    __delay_ms(1);
}

void Lin_Col_pos(char Lin, char Col)
{
    if(Lin == 2)
    {
       Send_CMD(0xC0+Col); 
    }
    else
    {
        Send_CMD(0x80+Col);
    }
}

void Send_String(char Lin, char Col, char *cadena)
{
    Lin_Col_pos(Lin, Col);
    while(*dat)
    {
        Send_CMD()
    }
}
